"use strict";
var template_1 = require("../src/template");
var fsharp_1 = require("../src/fsharp");
var dom_1 = require("../src/dom");
var rebind_1 = require("../src/rebind");
var ibrahim = {
    age: 36,
    firstName: "Ibrahim",
    lastName: "ben Salah",
    adult: true
};
describe("templating", function () {
    it("text template", function () {
        var tpl = new template_1.Template.TextTemplate(fsharp_1.fsharp("p.firstName"));
        var store = new rebind_1.Reactive.Store({ p: ibrahim });
        var binding = tpl.accept({
            text: function (ast) {
                var binding = new dom_1.Dom.TextBinding(ast);
                binding.update(store);
                return binding;
            }
        });
        store.get("p").get("firstName").set("bla");
        expect(binding.state).toBe("Ibrahim");
        store.flush();
        expect(binding.state).toBe("bla");
        expect(store.dirty.length).toBe(0);
        expect(binding.dependencies.length).toBe(2);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGVTcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3BlYy90ZW1wbGF0ZVNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLDRDQUEyQztBQUMzQyx3Q0FBNkM7QUFDN0Msa0NBQWlDO0FBQ2pDLHdDQUErQztBQUsvQyxJQUFJLE9BQU8sR0FBWTtJQUNuQixHQUFHLEVBQUUsRUFBRTtJQUNQLFNBQVMsRUFBRSxTQUFTO0lBQ3BCLFFBQVEsRUFBRSxXQUFXO0lBQ3JCLEtBQUssRUFBRSxJQUFJO0NBQ2QsQ0FBQztBQUVGLFFBQVEsQ0FBQyxZQUFZLEVBQ2pCO0lBQ0ksRUFBRSxDQUFDLGVBQWUsRUFDZDtRQUNJLElBQUksR0FBRyxHQUFHLElBQUksbUJBQVEsQ0FBQyxZQUFZLENBQUMsZUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7UUFDdkQsSUFBSSxLQUFLLEdBQUcsSUFBSSxpQkFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBRXpDLElBQUksT0FBTyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUM7WUFDckIsSUFBSSxZQUFDLEdBQUc7Z0JBQ0osSUFBSSxPQUFPLEdBQUcsSUFBSSxTQUFHLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN2QyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0QixNQUFNLENBQUMsT0FBTyxDQUFDO1lBQ25CLENBQUM7U0FDSixDQUFDLENBQUM7UUFFSCxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdEMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25DLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRCxDQUFDLENBQUMsQ0FBQztBQUNYLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL25vZGVfbW9kdWxlcy9AdHlwZXMvamFzbWluZS9pbmRleC5kLnRzXCIgLz5cclxuXHJcbmltcG9ydCB7IFRlbXBsYXRlIH0gZnJvbSBcIi4uL3NyYy90ZW1wbGF0ZVwiO1xyXG5pbXBvcnQgeyBmc2hhcnAgYXMgZnMgfSBmcm9tIFwiLi4vc3JjL2ZzaGFycFwiO1xyXG5pbXBvcnQgeyBEb20gfSBmcm9tIFwiLi4vc3JjL2RvbVwiO1xyXG5pbXBvcnQgeyBSZWFjdGl2ZSBhcyBSZSB9IGZyb20gJy4uL3NyYy9yZWJpbmQnO1xyXG4vLyBpbXBvcnQgeyBDb3JlIH0gZnJvbSBcIi4uL3NyYy9jb3JlXCI7XHJcblxyXG5pbnRlcmZhY2UgSVBlcnNvbiB7IGZpcnN0TmFtZTogc3RyaW5nOyBsYXN0TmFtZTogc3RyaW5nOyBhZHVsdDogYm9vbGVhbiwgYWdlOiBudW1iZXIgfVxyXG5cclxudmFyIGlicmFoaW06IElQZXJzb24gPSB7XHJcbiAgICBhZ2U6IDM2LFxyXG4gICAgZmlyc3ROYW1lOiBcIklicmFoaW1cIixcclxuICAgIGxhc3ROYW1lOiBcImJlbiBTYWxhaFwiLFxyXG4gICAgYWR1bHQ6IHRydWVcclxufTtcclxuXHJcbmRlc2NyaWJlKFwidGVtcGxhdGluZ1wiLFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICAgIGl0KFwidGV4dCB0ZW1wbGF0ZVwiLFxyXG4gICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHBsID0gbmV3IFRlbXBsYXRlLlRleHRUZW1wbGF0ZShmcyhcInAuZmlyc3ROYW1lXCIpKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IG5ldyBSZS5TdG9yZSh7IHA6IGlicmFoaW0gfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGJpbmRpbmcgPSB0cGwuYWNjZXB0KHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0KGFzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmluZGluZyA9IG5ldyBEb20uVGV4dEJpbmRpbmcoYXN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmluZGluZy51cGRhdGUoc3RvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmluZGluZztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzdG9yZS5nZXQoXCJwXCIpLmdldChcImZpcnN0TmFtZVwiKS5zZXQoXCJibGFcIik7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoYmluZGluZy5zdGF0ZSkudG9CZShcIklicmFoaW1cIik7XHJcbiAgICAgICAgICAgICAgICBzdG9yZS5mbHVzaCgpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGJpbmRpbmcuc3RhdGUpLnRvQmUoXCJibGFcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KHN0b3JlLmRpcnR5Lmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChiaW5kaW5nLmRlcGVuZGVuY2llcy5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7Il19