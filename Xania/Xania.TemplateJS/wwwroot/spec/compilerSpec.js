"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var reactive_1 = require("../src/reactive");
var query_1 = require("../src/query");
var observables_1 = require("../src/observables");
var ibrahim = {
    age: 36,
    firstName: "Ibrahim",
    lastName: "ben Salah",
    adult: true
};
describe("query parser", function () {
    it(':: fun x -> x ', function () {
        var ast = query_1.default("fun x -> x").ast;
        expect(ast).toBeDefined();
        var compose = ast;
        expect(compose.type).toBe("lambda");
        expect(compose.param).toBe("x");
        expect(compose.body.name).toBe("x");
    });
    it(':: .firstName ', function () {
        var ast = query_1.default(".firstName").ast;
        expect(ast).toBeDefined();
        var compose = ast;
        expect(compose.type).toBe("lambda");
        expect(compose.param).toBe("x");
        expect(compose.body.target.name).toBe("x");
        expect(compose.body.member.name).toBe("firstName");
    });
    it(':: 1 + 2', function () {
        var ast = query_1.default("1 + 2").ast;
        expect(ast).toBeDefined();
        var expr = ast;
        expect(expr.type).toBe(query_1.TOKENS.BINARY);
    });
    it(':: fn a', function () {
        var ast = query_1.default("fun a").ast;
        expect(ast).toBeDefined();
        var expr = ast;
        expect(expr.type).toBe(query_1.TOKENS.APP);
        expect(expr.fun).toEqual({ type: query_1.TOKENS.IDENT, name: 'fun' });
        expect(expr.args).toEqual([{ type: query_1.TOKENS.IDENT, name: "a" }]);
    });
    it(':: fn ()', function () {
        var ast = query_1.default("fun ()").ast;
        expect(ast).toBeDefined();
        var expr = ast;
        expect(expr.type).toBe(query_1.TOKENS.APP);
        expect(expr.fun).toEqual({ type: query_1.TOKENS.IDENT, name: 'fun' });
        expect(expr.args.length).toBe(0);
    });
    it(':: (+) a b', function () {
        var ast = query_1.default("(+) a b").ast;
        expect(ast).toBeDefined();
        var expr = ast;
        expect(expr).toEqual({ "type": query_1.TOKENS.APP, "fun": "+", "args": [{ "type": query_1.TOKENS.IDENT, "name": "a" }, { "type": query_1.TOKENS.IDENT, "name": "b" }] });
    });
    it(':: a |> b |> c', function () {
        var ast = query_1.default("a |> b |> c").ast;
        expect(ast).toBeDefined();
        var pipe1 = ast;
        expect(pipe1.type).toBe(query_1.TOKENS.BINARY);
        expect(pipe1.op).toBe("|>");
        expect(pipe1.right).toEqual({ "type": query_1.TOKENS.IDENT, "name": "c" });
        var pipe2 = pipe1.left;
        expect(pipe2.type).toBe(query_1.TOKENS.BINARY);
        expect(pipe2.op).toBe("|>");
        expect(pipe2.right).toEqual({ "type": query_1.TOKENS.IDENT, "name": "b" });
        expect(pipe2.left).toEqual({ "type": query_1.TOKENS.IDENT, "name": "a" });
    });
    it(':: a + b |> c', function () {
        var ast = query_1.default("a + b |> c").ast;
        expect(ast).toBeDefined();
        var pipe = ast;
        expect(pipe.type).toBe(query_1.TOKENS.BINARY);
        expect(pipe.op).toBe("|>");
        expect(pipe.right).toEqual({ type: query_1.TOKENS.IDENT, name: "c" });
        var add = pipe.left;
        expect(add.right.name).toBe("b");
        expect(add.left.name).toBe("a");
    });
    it(':: a >> b ', function () {
        var ast = query_1.default("a >> b").ast;
        expect(ast).toBeDefined();
        var compose = ast;
        expect(compose.type).toBe(query_1.TOKENS.COMPOSE, JSON.stringify(ast, null, 2));
        expect(compose.fun).toBe(">>", JSON.stringify(ast, null, 2));
        expect(compose.args[0].name).toBe("b", JSON.stringify(compose.args[0], null, 2));
        expect(compose.args[1].name).toBe("a", JSON.stringify(compose.args[1], null, 2));
    });
    it(':: a.b ', function () {
        var ast = query_1.default("a.b").ast;
        expect(ast).toBeDefined();
        var compose = ast;
        expect(compose.type).toBe(query_1.TOKENS.MEMBER, JSON.stringify(ast, null, 2));
        expect(compose.target.name).toBe("a", JSON.stringify(ast, null, 2));
        expect(compose.member).toBe("b", JSON.stringify(ast, null, 2));
    });
    it(':: [1..n] ', function () {
        var ast = query_1.default("[1..n]").ast;
        expect(ast).toBeDefined();
        var range = ast;
        expect(range.type).toBe(query_1.TOKENS.RANGE, JSON.stringify(ast, null, 2));
        expect(range.from.value).toBe(1, JSON.stringify(ast, null, 2));
        expect(range.to.name).toBe("n", JSON.stringify(ast, null, 2));
    });
    it(':: for p in people where p.adult ', function () {
        var ast = query_1.default("for p in people where p.adult").ast;
        expect(ast).toBeDefined();
        var where = ast;
        expect(where.type).toBe(query_1.TOKENS.WHERE);
        expect(where.predicate.type).toBe(query_1.TOKENS.MEMBER);
        expect(where.source.type).toBe(query_1.TOKENS.QUERY);
    });
    it(":: empty list -> 'list is empty' ", function () {
        var rule = query_1.default("empty list -> 'list is empty'").ast;
        expect(rule).toBeDefined();
        expect(rule.type).toBe(query_1.TOKENS.BINARY);
        expect(rule.op).toBe("->");
        expect(rule.right.value).toBe('list is empty');
    });
    it(':: regression test', function () {
        var start = new Date().getTime();
        var ast = query_1.default("a |> b.c >> (+) 1 |> d");
        for (var i = 0; i < 1000; i++) {
            query_1.default("a |> b >> (+) 1 |> d");
        }
        var elapsed = new Date().getTime() - start;
        if (elapsed > 2000)
            fail("too slow");
        expect(ast).toEqual({
            "type": query_1.TOKENS.BINARY,
            "op": "|>",
            "right": {
                "type": query_1.TOKENS.IDENT,
                "name": "d"
            },
            "left": {
                "type": query_1.TOKENS.BINARY,
                "op": "|>",
                "right": {
                    "type": query_1.TOKENS.COMPOSE,
                    "fun": ">>",
                    "args": [
                        {
                            "type": query_1.TOKENS.APP,
                            "fun": "+",
                            "args": [
                                {
                                    "type": query_1.TOKENS.CONST,
                                    "value": 1
                                }
                            ]
                        },
                        {
                            "type": query_1.TOKENS.MEMBER,
                            "target": {
                                "type": query_1.TOKENS.IDENT,
                                "name": "b"
                            },
                            "member": "c"
                        }
                    ]
                },
                "left": {
                    "type": query_1.TOKENS.IDENT,
                    "name": "a"
                }
            }
        });
    });
});
var TestBinding = (function (_super) {
    __extends(TestBinding, _super);
    function TestBinding(ast) {
        var _this = _super.call(this) || this;
        _this.ast = ast;
        return _this;
    }
    TestBinding.prototype.render = function (context) {
        this.context = context;
    };
    TestBinding.prototype.app = function (fun, args) {
        if (fun === "assign") {
            var value = args[0].valueOf();
            args[1].set(value);
            return value;
        }
        return _super.prototype.app.call(this, fun, args);
    };
    return TestBinding;
}(reactive_1.Reactive.Binding));
describe("runtime", function () {
    it("expression dependencies", function () {
        var store = new reactive_1.Reactive.Store({ p: ibrahim });
        var binding = new TestBinding(query_1.default("p.firstName"));
        binding.render(store);
        expect(binding.value).toBe("Ibrahim");
        store.get("p").get("firstName").set("Mr Ibraihm");
        expect(binding.value).toBe("Mr Ibraihm");
    });
    it("consistent variable identity", function () {
        var store = new reactive_1.Reactive.Store({ p: ibrahim });
        var binding = new TestBinding(query_1.default("p"));
        expect(binding.render(store)).toBe(binding.render(store));
    });
    it("consistent member identity", function () {
        var store = new reactive_1.Reactive.Store({ xania: { owner: ibrahim } });
        var binding = new TestBinding(query_1.default("xania.owner"));
        expect(binding.render(store)).toBe(binding.render(store));
    });
    it("consistent query identity", function () {
        var store = new reactive_1.Reactive.Store({ xania: { employees: [ibrahim] } });
        var binding = new TestBinding(query_1.default("for e in xania.employees"));
        expect(binding.render(store)[0]).toBe(binding.render(store)[0], "not identical");
    });
    it("assign expression", function () {
        var store = new reactive_1.Reactive.Store({ x: 1, y: 2, sum: 0 });
        var binding = new TestBinding(query_1.default("sum <- x + y"));
        binding.render(store);
        expect(store.get("sum").valueOf()).toBe(3);
    });
    it('await observable', function () {
        var observable = new observables_1.Observables.Observable(123);
        var store = new reactive_1.Reactive.Store({ observable: observable });
        var binding = new TestBinding(query_1.default("await observable"));
        binding.render(store);
        expect(binding.value).toBe(123);
        observable.notify(456);
        expect(binding.value).toBe(456);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsZXJTcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY29tcGlsZXJTcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVBLDRDQUFpRDtBQUNqRCxzQ0FBNkM7QUFDN0Msa0RBQWlEO0FBSWpELElBQUksT0FBTyxHQUFZO0lBQ25CLEdBQUcsRUFBRSxFQUFFO0lBQ1AsU0FBUyxFQUFFLFNBQVM7SUFDcEIsUUFBUSxFQUFFLFdBQVc7SUFDckIsS0FBSyxFQUFFLElBQUk7Q0FDZCxDQUFDO0FBRUYsUUFBUSxDQUFDLGNBQWMsRUFBRTtJQUVyQixFQUFFLENBQUMsZ0JBQWdCLEVBQ2Y7UUFDSSxJQUFJLEdBQUcsR0FBRyxlQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxDQUFDO1FBQ2xDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUUxQixJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUM7UUFDbEIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDaEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0lBRVAsRUFBRSxDQUFDLGdCQUFnQixFQUNmO1FBQ0ksSUFBSSxHQUFHLEdBQUcsZUFBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUNsQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFMUIsSUFBSSxPQUFPLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxD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QUFPLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRWhDLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDLENBQUM7QUFFWCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9ub2RlX21vZHVsZXMvQHR5cGVzL2phc21pbmUvaW5kZXguZC50c1wiIC8+XHJcblxyXG5pbXBvcnQgeyBSZWFjdGl2ZSBhcyBSZSB9IGZyb20gXCIuLi9zcmMvcmVhY3RpdmVcIjtcclxuaW1wb3J0IHF1ZXJ5LCB7IFRPS0VOUyB9IGZyb20gXCIuLi9zcmMvcXVlcnlcIjtcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZXMgfSBmcm9tIFwiLi4vc3JjL29ic2VydmFibGVzXCI7XHJcblxyXG5pbnRlcmZhY2UgSVBlcnNvbiB7IGZpcnN0TmFtZTogc3RyaW5nOyBsYXN0TmFtZTogc3RyaW5nOyBhZHVsdDogYm9vbGVhbiwgYWdlOiBudW1iZXIgfVxyXG5cclxudmFyIGlicmFoaW06IElQZXJzb24gPSB7XHJcbiAgICBhZ2U6IDM2LFxyXG4gICAgZmlyc3ROYW1lOiBcIklicmFoaW1cIixcclxuICAgIGxhc3ROYW1lOiBcImJlbiBTYWxhaFwiLFxyXG4gICAgYWR1bHQ6IHRydWVcclxufTtcclxuXHJcbmRlc2NyaWJlKFwicXVlcnkgcGFyc2VyXCIsICgpID0+IHtcclxuXHJcbiAgICBpdCgnOjogZnVuIHggLT4geCAnLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIGFzdCA9IHF1ZXJ5KFwiZnVuIHggLT4geFwiKS5hc3Q7XHJcbiAgICAgICAgICAgIGV4cGVjdChhc3QpLnRvQmVEZWZpbmVkKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY29tcG9zZSA9IGFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbXBvc2UudHlwZSkudG9CZShcImxhbWJkYVwiKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbXBvc2UucGFyYW0pLnRvQmUoXCJ4XCIpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29tcG9zZS5ib2R5Lm5hbWUpLnRvQmUoXCJ4XCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGl0KCc6OiAuZmlyc3ROYW1lICcsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCIuZmlyc3ROYW1lXCIpLmFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGFzdCkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb21wb3NlID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoY29tcG9zZS50eXBlKS50b0JlKFwibGFtYmRhXCIpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29tcG9zZS5wYXJhbSkudG9CZShcInhcIik7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb21wb3NlLmJvZHkudGFyZ2V0Lm5hbWUpLnRvQmUoXCJ4XCIpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29tcG9zZS5ib2R5Lm1lbWJlci5uYW1lKS50b0JlKFwiZmlyc3ROYW1lXCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGl0KCc6OiAxICsgMicsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCIxICsgMlwiKS5hc3Q7XHJcbiAgICAgICAgICAgIGV4cGVjdChhc3QpLnRvQmVEZWZpbmVkKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZXhwciA9IGFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGV4cHIudHlwZSkudG9CZShUT0tFTlMuQklOQVJZKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogZm4gYScsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCJmdW4gYVwiKS5hc3Q7XHJcbiAgICAgICAgICAgIGV4cGVjdChhc3QpLnRvQmVEZWZpbmVkKCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZXhwciA9IGFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGV4cHIudHlwZSkudG9CZShUT0tFTlMuQVBQKTtcclxuICAgICAgICAgICAgZXhwZWN0KGV4cHIuZnVuKS50b0VxdWFsKHsgdHlwZTogVE9LRU5TLklERU5ULCBuYW1lOiAnZnVuJyB9KTtcclxuICAgICAgICAgICAgZXhwZWN0KGV4cHIuYXJncykudG9FcXVhbChbeyB0eXBlOiBUT0tFTlMuSURFTlQsIG5hbWU6IFwiYVwiIH1dKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogZm4gKCknLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIGFzdCA9IHF1ZXJ5KFwiZnVuICgpXCIpLmFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGFzdCkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBleHByID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoZXhwci50eXBlKS50b0JlKFRPS0VOUy5BUFApO1xyXG4gICAgICAgICAgICBleHBlY3QoZXhwci5mdW4pLnRvRXF1YWwoeyB0eXBlOiBUT0tFTlMuSURFTlQsIG5hbWU6ICdmdW4nIH0pO1xyXG4gICAgICAgICAgICBleHBlY3QoZXhwci5hcmdzLmxlbmd0aCkudG9CZSgwKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogKCspIGEgYicsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCIoKykgYSBiXCIpLmFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGFzdCkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBleHByID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoZXhwcikudG9FcXVhbCh7IFwidHlwZVwiOiBUT0tFTlMuQVBQLCBcImZ1blwiOiBcIitcIiwgXCJhcmdzXCI6IFt7IFwidHlwZVwiOiBUT0tFTlMuSURFTlQsIFwibmFtZVwiOiBcImFcIiB9LCB7IFwidHlwZVwiOiBUT0tFTlMuSURFTlQsIFwibmFtZVwiOiBcImJcIiB9XSB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogYSB8PiBiIHw+IGMnLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIGFzdCA9IHF1ZXJ5KFwiYSB8PiBiIHw+IGNcIikuYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoYXN0KS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBpcGUxID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZTEudHlwZSkudG9CZShUT0tFTlMuQklOQVJZKTtcclxuICAgICAgICAgICAgZXhwZWN0KHBpcGUxLm9wKS50b0JlKFwifD5cIik7XHJcbiAgICAgICAgICAgIGV4cGVjdChwaXBlMS5yaWdodCkudG9FcXVhbCh7IFwidHlwZVwiOiBUT0tFTlMuSURFTlQsIFwibmFtZVwiOiBcImNcIiB9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwaXBlMiA9IHBpcGUxLmxlZnQ7XHJcbiAgICAgICAgICAgIGV4cGVjdChwaXBlMi50eXBlKS50b0JlKFRPS0VOUy5CSU5BUlkpO1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZTIub3ApLnRvQmUoXCJ8PlwiKTtcclxuICAgICAgICAgICAgZXhwZWN0KHBpcGUyLnJpZ2h0KS50b0VxdWFsKHsgXCJ0eXBlXCI6IFRPS0VOUy5JREVOVCwgXCJuYW1lXCI6IFwiYlwiIH0pO1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZTIubGVmdCkudG9FcXVhbCh7IFwidHlwZVwiOiBUT0tFTlMuSURFTlQsIFwibmFtZVwiOiBcImFcIiB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogYSArIGIgfD4gYycsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCJhICsgYiB8PiBjXCIpLmFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KGFzdCkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwaXBlID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZS50eXBlKS50b0JlKFRPS0VOUy5CSU5BUlkpO1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZS5vcCkudG9CZShcInw+XCIpO1xyXG4gICAgICAgICAgICBleHBlY3QocGlwZS5yaWdodCkudG9FcXVhbCh7IHR5cGU6IFRPS0VOUy5JREVOVCwgbmFtZTogXCJjXCIgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgYWRkID0gcGlwZS5sZWZ0O1xyXG4gICAgICAgICAgICBleHBlY3QoYWRkLnJpZ2h0Lm5hbWUpLnRvQmUoXCJiXCIpO1xyXG4gICAgICAgICAgICBleHBlY3QoYWRkLmxlZnQubmFtZSkudG9CZShcImFcIik7XHJcblxyXG4gICAgICAgICAgICAvLyBbe1widHlwZVwiOlwicGlwZVwiLFwiZnVuXCI6XCJ8PlwiLFwiYXJnc1wiOlt7XCJ0eXBlXCI6VE9LRU5TLklERU5ULFwibmFtZVwiOlwiY1wifSx7XCJ0eXBlXCI6XCJwaXBlXCIsXCJmdW5cIjpcInw+XCIsXCJhcmdzXCI6W3tcInR5cGVcIjpUT0tFTlMuSURFTlQsXCJuYW1lXCI6XCJiXCJ9LHtcInR5cGVcIjpUT0tFTlMuSURFTlQsXCJuYW1lXCI6XCJhXCJ9XX1dfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogYSA+PiBiICcsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCJhID4+IGJcIikuYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoYXN0KS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbXBvc2UgPSBhc3Q7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb21wb3NlLnR5cGUpLnRvQmUoVE9LRU5TLkNPTVBPU0UsIEpTT04uc3RyaW5naWZ5KGFzdCwgbnVsbCwgMikpO1xyXG4gICAgICAgICAgICBleHBlY3QoY29tcG9zZS5mdW4pLnRvQmUoXCI+PlwiLCBKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsIDIpKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbXBvc2UuYXJnc1swXS5uYW1lKS50b0JlKFwiYlwiLCBKU09OLnN0cmluZ2lmeShjb21wb3NlLmFyZ3NbMF0sIG51bGwsIDIpKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbXBvc2UuYXJnc1sxXS5uYW1lKS50b0JlKFwiYVwiLCBKU09OLnN0cmluZ2lmeShjb21wb3NlLmFyZ3NbMV0sIG51bGwsIDIpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogYS5iICcsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCJhLmJcIikuYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoYXN0KS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvbXBvc2UgPSBhc3Q7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb21wb3NlLnR5cGUpLnRvQmUoVE9LRU5TLk1FTUJFUiwgSlNPTi5zdHJpbmdpZnkoYXN0LCBudWxsLCAyKSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChjb21wb3NlLnRhcmdldC5uYW1lKS50b0JlKFwiYVwiLCBKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsIDIpKTtcclxuICAgICAgICAgICAgZXhwZWN0KGNvbXBvc2UubWVtYmVyKS50b0JlKFwiYlwiLCBKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsIDIpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnOjogWzEuLm5dICcsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgYXN0ID0gcXVlcnkoXCJbMS4ubl1cIikuYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoYXN0KS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHJhbmdlID0gYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QocmFuZ2UudHlwZSkudG9CZShUT0tFTlMuUkFOR0UsIEpTT04uc3RyaW5naWZ5KGFzdCwgbnVsbCwgMikpO1xyXG4gICAgICAgICAgICBleHBlY3QocmFuZ2UuZnJvbS52YWx1ZSkudG9CZSgxLCBKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsIDIpKTtcclxuICAgICAgICAgICAgZXhwZWN0KHJhbmdlLnRvLm5hbWUpLnRvQmUoXCJuXCIsIEpTT04uc3RyaW5naWZ5KGFzdCwgbnVsbCwgMikpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGl0KCc6OiBmb3IgcCBpbiBwZW9wbGUgd2hlcmUgcC5hZHVsdCAnLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIGFzdCA9IHF1ZXJ5KFwiZm9yIHAgaW4gcGVvcGxlIHdoZXJlIHAuYWR1bHRcIikuYXN0O1xyXG4gICAgICAgICAgICBleHBlY3QoYXN0KS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHdoZXJlID0gYXN0O1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KHdoZXJlLnR5cGUpLnRvQmUoVE9LRU5TLldIRVJFKTtcclxuICAgICAgICAgICAgZXhwZWN0KHdoZXJlLnByZWRpY2F0ZS50eXBlKS50b0JlKFRPS0VOUy5NRU1CRVIpO1xyXG4gICAgICAgICAgICBleHBlY3Qod2hlcmUuc291cmNlLnR5cGUpLnRvQmUoVE9LRU5TLlFVRVJZKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdChcIjo6IGVtcHR5IGxpc3QgLT4gJ2xpc3QgaXMgZW1wdHknIFwiLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIHJ1bGUgPSBxdWVyeShcImVtcHR5IGxpc3QgLT4gJ2xpc3QgaXMgZW1wdHknXCIpLmFzdDtcclxuICAgICAgICAgICAgZXhwZWN0KHJ1bGUpLnRvQmVEZWZpbmVkKCk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QocnVsZS50eXBlKS50b0JlKFRPS0VOUy5CSU5BUlkpO1xyXG4gICAgICAgICAgICBleHBlY3QocnVsZS5vcCkudG9CZShcIi0+XCIpO1xyXG4gICAgICAgICAgICBleHBlY3QocnVsZS5yaWdodC52YWx1ZSkudG9CZSgnbGlzdCBpcyBlbXB0eScpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICBpdCgnOjogcmVncmVzc2lvbiB0ZXN0JyxcclxuICAgICAgICAoKSA9PiB7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBhc3QgPSBxdWVyeShcImEgfD4gYi5jID4+ICgrKSAxIHw+IGRcIik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTAwMDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeShcImEgfD4gYiA+PiAoKykgMSB8PiBkXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBlbGFwc2VkID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSBzdGFydDtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbGFwc2VkID4gMjAwMCkgZmFpbChcInRvbyBzbG93XCIpO1xyXG5cclxuICAgICAgICAgICAgZXhwZWN0KGFzdCkudG9FcXVhbChcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogVE9LRU5TLkJJTkFSWSxcclxuICAgICAgICAgICAgICAgICAgICBcIm9wXCI6IFwifD5cIixcclxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFRPS0VOUy5JREVOVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogVE9LRU5TLkJJTkFSWSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJvcFwiOiBcInw+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFRPS0VOUy5DT01QT1NFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmdW5cIjogXCI+PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmdzXCI6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBUT0tFTlMuQVBQLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZ1blwiOiBcIitcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmdzXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogVE9LRU5TLkNPTlNULFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBUT0tFTlMuTUVNQkVSLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRhcmdldFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogVE9LRU5TLklERU5ULFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiYlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVtYmVyXCI6IFwiY1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFRPS0VOUy5JREVOVCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcImFcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbn0pO1xyXG5cclxuXHJcbmNsYXNzIFRlc3RCaW5kaW5nIGV4dGVuZHMgUmUuQmluZGluZyB7XHJcbiAgICBwdWJsaWMgdmFsdWU7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhc3QpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcihjb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgICAgICAvLyByZXR1cm4gdGhpcy52YWx1ZSA9IGFjY2VwdCh0aGlzLmFzdCwgdGhpcywgY29udGV4dCkudmFsdWVPZigpO1xyXG4gICAgfVxyXG5cclxuICAgIGFwcChmdW4sIGFyZ3M6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGZ1biA9PT0gXCJhc3NpZ25cIikge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBhcmdzWzBdLnZhbHVlT2YoKTtcclxuICAgICAgICAgICAgYXJnc1sxXS5zZXQodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc3VwZXIuYXBwKGZ1biwgYXJncyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmRlc2NyaWJlKFwicnVudGltZVwiLCAoKSA9PiB7XHJcblxyXG4gICAgaXQoXCJleHByZXNzaW9uIGRlcGVuZGVuY2llc1wiLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIHN0b3JlID0gbmV3IFJlLlN0b3JlKHsgcDogaWJyYWhpbSB9KTtcclxuICAgICAgICAgICAgdmFyIGJpbmRpbmcgPSBuZXcgVGVzdEJpbmRpbmcocXVlcnkoXCJwLmZpcnN0TmFtZVwiKSk7XHJcbiAgICAgICAgICAgIGJpbmRpbmcucmVuZGVyKHN0b3JlKTtcclxuXHJcbiAgICAgICAgICAgIGV4cGVjdChiaW5kaW5nLnZhbHVlKS50b0JlKFwiSWJyYWhpbVwiKTtcclxuICAgICAgICAgICAgLy8gZXhwZWN0KGJpbmRpbmcuZGVwZW5kZW5jaWVzLmxlbmd0aCkudG9CZSgyKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGV4cGVjdChzdG9yZS5kaXJ0eS5sZW5ndGgpLnRvQmUoMCk7XHJcblxyXG4gICAgICAgICAgICBzdG9yZS5nZXQoXCJwXCIpLmdldChcImZpcnN0TmFtZVwiKS5zZXQoXCJNciBJYnJhaWhtXCIpO1xyXG4gICAgICAgICAgICBleHBlY3QoYmluZGluZy52YWx1ZSkudG9CZShcIk1yIElicmFpaG1cIik7XHJcblxyXG4gICAgICAgICAgICAvLyBleHBlY3QoYmluZGluZy5kZXBlbmRlbmNpZXMubGVuZ3RoKS50b0JlKDIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGl0KFwiY29uc2lzdGVudCB2YXJpYWJsZSBpZGVudGl0eVwiLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIHN0b3JlID0gbmV3IFJlLlN0b3JlKHsgcDogaWJyYWhpbSB9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5nID0gbmV3IFRlc3RCaW5kaW5nKHF1ZXJ5KFwicFwiKSk7XHJcblxyXG4gICAgICAgICAgICBleHBlY3QoYmluZGluZy5yZW5kZXIoc3RvcmUpKS50b0JlKGJpbmRpbmcucmVuZGVyKHN0b3JlKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgaXQoXCJjb25zaXN0ZW50IG1lbWJlciBpZGVudGl0eVwiLCAoKSA9PiB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gbmV3IFJlLlN0b3JlKHsgeGFuaWE6IHsgb3duZXI6IGlicmFoaW0gfSB9KTtcclxuICAgICAgICB2YXIgYmluZGluZyA9IG5ldyBUZXN0QmluZGluZyhxdWVyeShcInhhbmlhLm93bmVyXCIpKTtcclxuICAgICAgICBleHBlY3QoYmluZGluZy5yZW5kZXIoc3RvcmUpKS50b0JlKGJpbmRpbmcucmVuZGVyKHN0b3JlKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdChcImNvbnNpc3RlbnQgcXVlcnkgaWRlbnRpdHlcIiwgKCkgPT4ge1xyXG4gICAgICAgIHZhciBzdG9yZSA9IG5ldyBSZS5TdG9yZSh7IHhhbmlhOiB7IGVtcGxveWVlczogW2licmFoaW1dIH0gfSk7XHJcbiAgICAgICAgdmFyIGJpbmRpbmcgPSBuZXcgVGVzdEJpbmRpbmcocXVlcnkoXCJmb3IgZSBpbiB4YW5pYS5lbXBsb3llZXNcIikpO1xyXG4gICAgICAgIGV4cGVjdChiaW5kaW5nLnJlbmRlcihzdG9yZSlbMF0pLnRvQmUoYmluZGluZy5yZW5kZXIoc3RvcmUpWzBdLCBcIm5vdCBpZGVudGljYWxcIik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdChcImFzc2lnbiBleHByZXNzaW9uXCIsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgc3RvcmUgPSBuZXcgUmUuU3RvcmUoeyB4OiAxLCB5OiAyLCBzdW06IDAgfSk7XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5nID0gbmV3IFRlc3RCaW5kaW5nKHF1ZXJ5KFwic3VtIDwtIHggKyB5XCIpKTtcclxuICAgICAgICAgICAgYmluZGluZy5yZW5kZXIoc3RvcmUpO1xyXG4gICAgICAgICAgICBleHBlY3Qoc3RvcmUuZ2V0KFwic3VtXCIpLnZhbHVlT2YoKSkudG9CZSgzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBpdCgnYXdhaXQgb2JzZXJ2YWJsZScsXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlcy5PYnNlcnZhYmxlKDEyMyk7XHJcbiAgICAgICAgICAgIHZhciBzdG9yZSA9IG5ldyBSZS5TdG9yZSh7IG9ic2VydmFibGUgfSk7XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5nID0gbmV3IFRlc3RCaW5kaW5nKHF1ZXJ5KFwiYXdhaXQgb2JzZXJ2YWJsZVwiKSk7XHJcblxyXG4gICAgICAgICAgICBiaW5kaW5nLnJlbmRlcihzdG9yZSk7XHJcbiAgICAgICAgICAgIGV4cGVjdChiaW5kaW5nLnZhbHVlKS50b0JlKDEyMyk7XHJcblxyXG4gICAgICAgICAgICBvYnNlcnZhYmxlLm5vdGlmeSg0NTYpO1xyXG4gICAgICAgICAgICBleHBlY3QoYmluZGluZy52YWx1ZSkudG9CZSg0NTYpO1xyXG4gICAgICAgIH0pO1xyXG5cclxufSk7XHJcblxyXG4iXX0=