"use strict";
var Template;
(function (Template) {
    var TextTemplate = (function () {
        function TextTemplate(expr) {
            this.expr = expr;
        }
        TextTemplate.prototype.toString = function () {
            return this.expr.toString();
        };
        TextTemplate.prototype.accept = function (visitor, options) {
            return visitor.text(this.expr, options);
        };
        return TextTemplate;
    }());
    Template.TextTemplate = TextTemplate;
    var ContentTemplate = (function () {
        function ContentTemplate(ast) {
            this.ast = ast;
            this.children = [];
        }
        ContentTemplate.prototype.child = function (child) {
            this.children.push(child);
            return this;
        };
        ContentTemplate.prototype.accept = function (visitor, options) {
            return visitor.content(this.ast, this.children, options);
        };
        return ContentTemplate;
    }());
    Template.ContentTemplate = ContentTemplate;
    var TagTemplate = (function () {
        function TagTemplate(name, ns) {
            this.name = name;
            this.ns = ns;
            this.attributes = [];
            this.events = new Map();
            this._children = [];
        }
        TagTemplate.prototype.children = function () {
            return this._children;
        };
        TagTemplate.prototype.attr = function (name, tpl) {
            return this.addAttribute(name, tpl);
        };
        TagTemplate.prototype.addAttribute = function (name, tpl) {
            var attr = this.getAttribute(name);
            if (!attr)
                this.attributes.push({ name: name.toLowerCase(), tpl: tpl });
            return this;
        };
        TagTemplate.prototype.getAttribute = function (name) {
            var key = name.toLowerCase();
            for (var i = 0; i < this.attributes.length; i++) {
                var attr = this.attributes[i];
                if (attr.name === key)
                    return attr;
            }
            return null;
        };
        TagTemplate.prototype.addEvent = function (name, callback) {
            this.events.set(name, callback);
        };
        TagTemplate.prototype.addChild = function (child) {
            this._children.push(child);
            return this;
        };
        TagTemplate.prototype.select = function (modelAccessor) {
            this.modelAccessor = modelAccessor;
            return this;
        };
        TagTemplate.prototype.accept = function (visitor) {
        };
        return TagTemplate;
    }());
    Template.TagTemplate = TagTemplate;
})(Template = exports.Template || (exports.Template = {}));
exports.t = Template;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGVtcGxhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLElBQWMsUUFBUSxDQW9JckI7QUFwSUQsV0FBYyxRQUFRO0lBWWxCO1FBQ0ksc0JBQW9CLElBQWE7WUFBYixTQUFJLEdBQUosSUFBSSxDQUFTO1FBQ2pDLENBQUM7UUFFRCwrQkFBUSxHQUFSO1lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDaEMsQ0FBQztRQUVELDZCQUFNLEdBQU4sVUFBVSxPQUFvQixFQUFFLE9BQVk7WUFDeEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUM1QyxDQUFDO1FBQ0wsbUJBQUM7SUFBRCxDQUFDLEFBWEQsSUFXQztJQVhZLHFCQUFZLGVBV3hCLENBQUE7SUFFRDtRQUlJLHlCQUFvQixHQUFHO1lBQUgsUUFBRyxHQUFILEdBQUcsQ0FBQTtZQUZmLGFBQVEsR0FBWSxFQUFFLENBQUM7UUFFSixDQUFDO1FBRTVCLCtCQUFLLEdBQUwsVUFBTSxLQUFZO1lBQ2QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDMUIsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRUQsZ0NBQU0sR0FBTixVQUFVLE9BQW9CLEVBQUUsT0FBWTtZQUN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDN0QsQ0FBQztRQXlCTCxzQkFBQztJQUFELENBQUMsQUF0Q0QsSUFzQ0M7SUF0Q1ksd0JBQWUsa0JBc0MzQixDQUFBO0lBRUQ7UUFPSSxxQkFBbUIsSUFBWSxFQUFVLEVBQVU7WUFBaEMsU0FBSSxHQUFKLElBQUksQ0FBUTtZQUFVLE9BQUUsR0FBRixFQUFFLENBQVE7WUFOM0MsZUFBVSxHQUE0QixFQUFFLENBQUM7WUFDekMsV0FBTSxHQUFHLElBQUksR0FBRyxFQUFlLENBQUM7WUFFaEMsY0FBUyxHQUFZLEVBQUUsQ0FBQztRQUloQyxDQUFDO1FBRU0sOEJBQVEsR0FBZjtZQUNJLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzFCLENBQUM7UUFFTSwwQkFBSSxHQUFYLFVBQVksSUFBWSxFQUFFLEdBQVE7WUFDOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3hDLENBQUM7UUFFTSxrQ0FBWSxHQUFuQixVQUFvQixJQUFZLEVBQUUsR0FBUTtZQUN0QyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ25DLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUNOLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUUsRUFBRSxHQUFHLEtBQUEsRUFBRSxDQUFDLENBQUM7WUFDNUQsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRU0sa0NBQVksR0FBbkIsVUFBb0IsSUFBWTtZQUM1QixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDN0IsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUM5QyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM5QixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLEdBQUcsQ0FBQztvQkFDbEIsTUFBTSxDQUFDLElBQUksQ0FBQztZQUNwQixDQUFDO1lBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRU0sOEJBQVEsR0FBZixVQUFnQixJQUFJLEVBQUUsUUFBUTtZQUMxQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDcEMsQ0FBQztRQUVNLDhCQUFRLEdBQWYsVUFBZ0IsS0FBa0I7WUFDOUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDM0IsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRU0sNEJBQU0sR0FBYixVQUFjLGFBQWE7WUFDdkIsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7WUFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRUQsNEJBQU0sR0FBTixVQUFVLE9BQW9CO1FBSzlCLENBQUM7UUFZTCxrQkFBQztJQUFELENBQUMsQUFsRUQsSUFrRUM7SUFsRVksb0JBQVcsY0FrRXZCLENBQUE7QUFDTCxDQUFDLEVBcElhLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBb0lyQjtBQUdlLHFCQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29yZSB9IGZyb20gXCIuL2NvcmVcIlxyXG5cclxuZXhwb3J0IG1vZHVsZSBUZW1wbGF0ZSB7XHJcblxyXG4gICAgZXhwb3J0IGludGVyZmFjZSBJVmlzaXRvcjxUPiB7XHJcbiAgICAgICAgdGV4dD8odHBsLCBvcHRpb25zOiBhbnkpOiBUO1xyXG4gICAgICAgIGNvbnRlbnQ/KGFzdCwgY2hpbGRyZW46IElOb2RlW10sIG9wdGlvbnM6IGFueSk6IFQ7XHJcbiAgICAgICAgdGFnPyhuYW1lLCBucywgYXR0ciwgZXZlbnRzLCBjaGlsZHJlbjogVFtdLCBvcHRpb25zOiBhbnkpOiBUO1xyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgSU5vZGUge1xyXG4gICAgICAgIGFjY2VwdDxUPih2aXNpdG9yOiBJVmlzaXRvcjxUPiwgb3B0aW9ucz86IGFueSk6IFQ7XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIFRleHRUZW1wbGF0ZSBpbXBsZW1lbnRzIElOb2RlIHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGV4cHIgOiBzdHJpbmcpIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRvU3RyaW5nKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leHByLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhY2NlcHQ8VD4odmlzaXRvcjogSVZpc2l0b3I8VD4sIG9wdGlvbnM6IGFueSk6IFQge1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvci50ZXh0KHRoaXMuZXhwciwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBDb250ZW50VGVtcGxhdGUgaW1wbGVtZW50cyBJTm9kZSB7XHJcbiAgICAgICAgLy8gUmVTaGFycGVyIGRpc2FibGUgb25jZSBJbmNvbnNpc3RlbnROYW1pbmdcclxuICAgICAgICBwcml2YXRlIGNoaWxkcmVuOiBJTm9kZVtdID0gW107XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXN0KSB7IH1cclxuXHJcbiAgICAgICAgY2hpbGQoY2hpbGQ6IElOb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWNjZXB0PFQ+KHZpc2l0b3I6IElWaXNpdG9yPFQ+LCBvcHRpb25zOiBhbnkpOiBUIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2l0b3IuY29udGVudCh0aGlzLmFzdCwgdGhpcy5jaGlsZHJlbiwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2JpbmQoY29udGV4dCkge1xyXG4gICAgICAgIC8vICAgIGNvbnN0IG5ld0JpbmRpbmcgPSBuZXcgRG9tLkNvbnRlbnRCaW5kaW5nKCk7XHJcbiAgICAgICAgLy8gICAgdGhpcy5jaGlsZHJlbigpXHJcbiAgICAgICAgLy8gICAgICAgIC8vIFJlU2hhcnBlciBkaXNhYmxlIG9uY2UgVHNSZXNvbHZlZEZyb21JbmFjY2Vzc2libGVNb2R1bGVcclxuICAgICAgICAvLyAgICAgICAgLnJlZHVjZShDb250ZW50VGVtcGxhdGUucmVkdWNlQ2hpbGQsXHJcbiAgICAgICAgLy8gICAgICAgIHsgY29udGV4dCwgb2Zmc2V0OiAwLCBwYXJlbnRCaW5kaW5nOiBuZXdCaW5kaW5nIH0pO1xyXG5cclxuICAgICAgICAvLyAgICBuZXdCaW5kaW5nLnVwZGF0ZShjb250ZXh0KTtcclxuXHJcbiAgICAgICAgLy8gICAgcmV0dXJuIG5ld0JpbmRpbmc7XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIC8vc3RhdGljIHJlZHVjZUNoaWxkKHByZXYsIGN1cjogSU5vZGUpIHtcclxuICAgICAgICAvLyAgICB2YXIgeyBwYXJlbnRCaW5kaW5nLCBjb250ZXh0LCBvZmZzZXQgfSA9IHByZXY7XHJcblxyXG4gICAgICAgIC8vICAgIHByZXYub2Zmc2V0ID0gQ29yZS5yZWFkeShvZmZzZXQsXHJcbiAgICAgICAgLy8gICAgICAgIHAgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgdmFyIHN0YXRlID0gRG9tLmV4ZWN1dGVUZW1wbGF0ZShjb250ZXh0LCBjdXIsIHBhcmVudEJpbmRpbmcuZG9tLCBwKTtcclxuICAgICAgICAvLyAgICAgICAgICAgIHJldHVybiBDb3JlLnJlYWR5KHN0YXRlLCB4ID0+IHsgcmV0dXJuIHAgKyB4LmJpbmRpbmdzLmxlbmd0aCB9KTtcclxuICAgICAgICAvLyAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vICAgIHJldHVybiBwcmV2O1xyXG4gICAgICAgIC8vfVxyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBUYWdUZW1wbGF0ZSBpbXBsZW1lbnRzIElOb2RlIHtcclxuICAgICAgICBwcml2YXRlIGF0dHJpYnV0ZXM6IHsgbmFtZTogc3RyaW5nOyB0cGwgfVtdID0gW107XHJcbiAgICAgICAgcHJpdmF0ZSBldmVudHMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xyXG4gICAgICAgIC8vIFJlU2hhcnBlciBkaXNhYmxlIG9uY2UgSW5jb25zaXN0ZW50TmFtaW5nXHJcbiAgICAgICAgcHJpdmF0ZSBfY2hpbGRyZW46IElOb2RlW10gPSBbXTtcclxuICAgICAgICBwdWJsaWMgbW9kZWxBY2Nlc3NvcjtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IocHVibGljIG5hbWU6IHN0cmluZywgcHJpdmF0ZSBuczogc3RyaW5nKSB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY2hpbGRyZW4oKTogSU5vZGVbXSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBhdHRyKG5hbWU6IHN0cmluZywgdHBsOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkQXR0cmlidXRlKG5hbWUsIHRwbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYWRkQXR0cmlidXRlKG5hbWU6IHN0cmluZywgdHBsOiBhbnkpIHtcclxuICAgICAgICAgICAgdmFyIGF0dHIgPSB0aGlzLmdldEF0dHJpYnV0ZShuYW1lKTtcclxuICAgICAgICAgICAgaWYgKCFhdHRyKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnB1c2goeyBuYW1lOiBuYW1lLnRvTG93ZXJDYXNlKCksIHRwbCB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgZ2V0QXR0cmlidXRlKG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gbmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGF0dHIgPSB0aGlzLmF0dHJpYnV0ZXNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoYXR0ci5uYW1lID09PSBrZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF0dHI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYWRkRXZlbnQobmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudHMuc2V0KG5hbWUsIGNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBhZGRDaGlsZChjaGlsZDogVGFnVGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4ucHVzaChjaGlsZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHNlbGVjdChtb2RlbEFjY2Vzc29yKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZWxBY2Nlc3NvciA9IG1vZGVsQWNjZXNzb3I7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWNjZXB0PFQ+KHZpc2l0b3I6IElWaXNpdG9yPFQ+KSB7XHJcbiAgICAgICAgICAgIC8vIHZhciBjaGlsZHJlbiA9IHRoaXMuX2NoaWxkcmVuLm1hcCh4ID0+IHguYWNjZXB0KHZpc2l0b3IpKTtcclxuICAgICAgICAgICAgLy8gdmFyIGNvbnRlbnQgPSB2aXNpdG9yLmNvbnRlbnQobnVsbCwgY2hpbGRyZW4pO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0dXJuIHZpc2l0b3IudGFnKHRoaXMubmFtZSwgdGhpcy5ucywgdGhpcy5hdHRyaWJ1dGVzLCB0aGlzLmV2ZW50cywgY29udGVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2JpbmQoY29udGV4dCkge1xyXG4gICAgICAgIC8vICAgIGNvbnN0IG5ld0JpbmRpbmcgPSBuZXcgRG9tLlRhZ0JpbmRpbmcodGhpcy5uYW1lLCB0aGlzLm5zLCB0aGlzLmF0dHJpYnV0ZXMsIHRoaXMuZXZlbnRzKTtcclxuICAgICAgICAvLyAgICB0aGlzLmNoaWxkcmVuKClcclxuICAgICAgICAvLyAgICAgICAgLnJlZHVjZShDb250ZW50VGVtcGxhdGUucmVkdWNlQ2hpbGQsXHJcbiAgICAgICAgLy8gICAgICAgIHsgY29udGV4dCwgb2Zmc2V0OiAwLCBwYXJlbnRCaW5kaW5nOiBuZXdCaW5kaW5nLCBtb2RlbEFjY2Vzc29yOiB0aGlzLm1vZGVsQWNjZXNzb3IgfSk7XHJcblxyXG4gICAgICAgIC8vICAgIG5ld0JpbmRpbmcudXBkYXRlKGNvbnRleHQpO1xyXG5cclxuICAgICAgICAvLyAgICByZXR1cm4gbmV3QmluZGluZztcclxuICAgICAgICAvL31cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIFRlbXBsYXRlIGFzIHRcclxufSJdfQ==