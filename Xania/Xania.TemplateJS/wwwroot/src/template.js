"use strict";
var Template;
(function (Template) {
    var TextTemplate = (function () {
        function TextTemplate(parts) {
            this.parts = parts;
        }
        TextTemplate.prototype.accept = function (visitor, options) {
            return visitor.text(this.parts, options);
        };
        return TextTemplate;
    }());
    Template.TextTemplate = TextTemplate;
    var ContentTemplate = (function () {
        function ContentTemplate(ast) {
            this.ast = ast;
            this.children = [];
        }
        ContentTemplate.prototype.child = function (child) {
            this.children.push(child);
            return this;
        };
        ContentTemplate.prototype.accept = function (visitor, options) {
            return visitor.content(this.ast, this.children, options);
        };
        return ContentTemplate;
    }());
    Template.ContentTemplate = ContentTemplate;
    var TagTemplate = (function () {
        function TagTemplate(name, ns) {
            this.name = name;
            this.ns = ns;
            this.attributes = [];
            this.events = new Map();
            this._children = [];
        }
        TagTemplate.prototype.children = function () {
            return this._children;
        };
        TagTemplate.prototype.attr = function (name, tpl) {
            return this.addAttribute(name, tpl);
        };
        TagTemplate.prototype.addAttribute = function (name, tpl) {
            var attr = this.getAttribute(name);
            if (!attr)
                this.attributes.push({ name: name.toLowerCase(), tpl: tpl });
            return this;
        };
        TagTemplate.prototype.getAttribute = function (name) {
            var key = name.toLowerCase();
            for (var i = 0; i < this.attributes.length; i++) {
                var attr = this.attributes[i];
                if (attr.name === key)
                    return attr;
            }
            return undefined;
        };
        TagTemplate.prototype.addEvent = function (name, callback) {
            this.events.set(name, callback);
        };
        TagTemplate.prototype.addChild = function (child) {
            this._children.push(child);
            return this;
        };
        TagTemplate.prototype.select = function (modelAccessor) {
            this.modelAccessor = modelAccessor;
            return this;
        };
        TagTemplate.prototype.accept = function (visitor, options) {
            var tag = visitor.tag(this.name, this.ns, this.attributes, null, options);
            this._children.forEach(function (x) { return x.accept(tag); });
            return tag;
        };
        return TagTemplate;
    }());
    Template.TagTemplate = TagTemplate;
})(Template = exports.Template || (exports.Template = {}));
exports.t = Template;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVtcGxhdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGVtcGxhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLElBQWMsUUFBUSxDQW1JckI7QUFuSUQsV0FBYyxRQUFRO0lBWWxCO1FBQ0ksc0JBQW9CLEtBQXNCO1lBQXRCLFVBQUssR0FBTCxLQUFLLENBQWlCO1FBQzFDLENBQUM7UUFFRCw2QkFBTSxHQUFOLFVBQVUsT0FBb0IsRUFBRSxPQUFZO1lBQ3hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDN0MsQ0FBQztRQUNMLG1CQUFDO0lBQUQsQ0FBQyxBQVBELElBT0M7SUFQWSxxQkFBWSxlQU94QixDQUFBO0lBRUQ7UUFJSSx5QkFBb0IsR0FBRztZQUFILFFBQUcsR0FBSCxHQUFHLENBQUE7WUFGZixhQUFRLEdBQVksRUFBRSxDQUFDO1FBRUosQ0FBQztRQUU1QiwrQkFBSyxHQUFMLFVBQU0sS0FBWTtZQUNkLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDaEIsQ0FBQztRQUVELGdDQUFNLEdBQU4sVUFBVSxPQUFvQixFQUFFLE9BQVk7WUFDeEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzdELENBQUM7UUF5Qkwsc0JBQUM7SUFBRCxDQUFDLEFBdENELElBc0NDO0lBdENZLHdCQUFlLGtCQXNDM0IsQ0FBQTtJQUVEO1FBT0kscUJBQW1CLElBQVksRUFBVSxFQUFVO1lBQWhDLFNBQUksR0FBSixJQUFJLENBQVE7WUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFRO1lBTjNDLGVBQVUsR0FBNEIsRUFBRSxDQUFDO1lBQ3pDLFdBQU0sR0FBRyxJQUFJLEdBQUcsRUFBZSxDQUFDO1lBRWhDLGNBQVMsR0FBWSxFQUFFLENBQUM7UUFJaEMsQ0FBQztRQUVNLDhCQUFRLEdBQWY7WUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUMxQixDQUFDO1FBRU0sMEJBQUksR0FBWCxVQUFZLElBQVksRUFBRSxHQUFRO1lBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN4QyxDQUFDO1FBRU0sa0NBQVksR0FBbkIsVUFBb0IsSUFBWSxFQUFFLEdBQVE7WUFDdEMsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNuQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztnQkFDTixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFLEVBQUUsR0FBRyxLQUFBLEVBQUUsQ0FBQyxDQUFDO1lBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFDaEIsQ0FBQztRQUVNLGtDQUFZLEdBQW5CLFVBQW9CLElBQVk7WUFDNUIsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzdCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDOUMsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDOUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxHQUFHLENBQUM7b0JBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDcEIsQ0FBQztZQUNELE1BQU0sQ0FBQyxTQUFTLENBQUM7UUFDckIsQ0FBQztRQUVNLDhCQUFRLEdBQWYsVUFBZ0IsSUFBSSxFQUFFLFFBQVE7WUFDMUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ3BDLENBQUM7UUFFTSw4QkFBUSxHQUFmLFVBQWdCLEtBQVk7WUFDeEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDM0IsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRU0sNEJBQU0sR0FBYixVQUFjLGFBQWE7WUFDdkIsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7WUFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQixDQUFDO1FBRUQsNEJBQU0sR0FBTixVQUFVLE9BQW9CLEVBQUUsT0FBWTtZQUN4QyxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztZQUMxRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQWIsQ0FBYSxDQUFDLENBQUM7WUFFM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQztRQUlmLENBQUM7UUFZTCxrQkFBQztJQUFELENBQUMsQUFyRUQsSUFxRUM7SUFyRVksb0JBQVcsY0FxRXZCLENBQUE7QUFDTCxDQUFDLEVBbklhLFFBQVEsR0FBUixnQkFBUSxLQUFSLGdCQUFRLFFBbUlyQjtBQUdlLHFCQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29yZSB9IGZyb20gXCIuL2NvcmVcIlxyXG5cclxuZXhwb3J0IG1vZHVsZSBUZW1wbGF0ZSB7XHJcblxyXG4gICAgZXhwb3J0IGludGVyZmFjZSBJVmlzaXRvcjxUPiB7XHJcbiAgICAgICAgdGV4dD8odHBsLCBvcHRpb25zOiBhbnkpOiBUO1xyXG4gICAgICAgIGNvbnRlbnQ/KGFzdCwgY2hpbGRyZW46IElOb2RlW10sIG9wdGlvbnM/OiBhbnkpOiBUO1xyXG4gICAgICAgIHRhZz8obmFtZSwgbnMsIGF0dHIsIGV2ZW50cywgb3B0aW9ucz86IGFueSk6IFQ7XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGludGVyZmFjZSBJTm9kZSB7XHJcbiAgICAgICAgYWNjZXB0PFQ+KHZpc2l0b3I6IElWaXNpdG9yPFQ+LCBvcHRpb25zPzogYW55KTogVDtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgY2xhc3MgVGV4dFRlbXBsYXRlIGltcGxlbWVudHMgSU5vZGUge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGFydHMgOiBhbnlbXSB8IHN0cmluZykge1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWNjZXB0PFQ+KHZpc2l0b3I6IElWaXNpdG9yPFQ+LCBvcHRpb25zOiBhbnkpOiBUIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2l0b3IudGV4dCh0aGlzLnBhcnRzLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIENvbnRlbnRUZW1wbGF0ZSBpbXBsZW1lbnRzIElOb2RlIHtcclxuICAgICAgICAvLyBSZVNoYXJwZXIgZGlzYWJsZSBvbmNlIEluY29uc2lzdGVudE5hbWluZ1xyXG4gICAgICAgIHByaXZhdGUgY2hpbGRyZW46IElOb2RlW10gPSBbXTtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSBhc3QpIHsgfVxyXG5cclxuICAgICAgICBjaGlsZChjaGlsZDogSU5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhY2NlcHQ8VD4odmlzaXRvcjogSVZpc2l0b3I8VD4sIG9wdGlvbnM6IGFueSk6IFQge1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvci5jb250ZW50KHRoaXMuYXN0LCB0aGlzLmNoaWxkcmVuLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vYmluZChjb250ZXh0KSB7XHJcbiAgICAgICAgLy8gICAgY29uc3QgbmV3QmluZGluZyA9IG5ldyBEb20uQ29udGVudEJpbmRpbmcoKTtcclxuICAgICAgICAvLyAgICB0aGlzLmNoaWxkcmVuKClcclxuICAgICAgICAvLyAgICAgICAgLy8gUmVTaGFycGVyIGRpc2FibGUgb25jZSBUc1Jlc29sdmVkRnJvbUluYWNjZXNzaWJsZU1vZHVsZVxyXG4gICAgICAgIC8vICAgICAgICAucmVkdWNlKENvbnRlbnRUZW1wbGF0ZS5yZWR1Y2VDaGlsZCxcclxuICAgICAgICAvLyAgICAgICAgeyBjb250ZXh0LCBvZmZzZXQ6IDAsIHBhcmVudEJpbmRpbmc6IG5ld0JpbmRpbmcgfSk7XHJcblxyXG4gICAgICAgIC8vICAgIG5ld0JpbmRpbmcudXBkYXRlKGNvbnRleHQpO1xyXG5cclxuICAgICAgICAvLyAgICByZXR1cm4gbmV3QmluZGluZztcclxuICAgICAgICAvL31cclxuXHJcbiAgICAgICAgLy9zdGF0aWMgcmVkdWNlQ2hpbGQocHJldiwgY3VyOiBJTm9kZSkge1xyXG4gICAgICAgIC8vICAgIHZhciB7IHBhcmVudEJpbmRpbmcsIGNvbnRleHQsIG9mZnNldCB9ID0gcHJldjtcclxuXHJcbiAgICAgICAgLy8gICAgcHJldi5vZmZzZXQgPSBDb3JlLnJlYWR5KG9mZnNldCxcclxuICAgICAgICAvLyAgICAgICAgcCA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB2YXIgc3RhdGUgPSBEb20uZXhlY3V0ZVRlbXBsYXRlKGNvbnRleHQsIGN1ciwgcGFyZW50QmluZGluZy5kb20sIHApO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuIENvcmUucmVhZHkoc3RhdGUsIHggPT4geyByZXR1cm4gcCArIHguYmluZGluZ3MubGVuZ3RoIH0pO1xyXG4gICAgICAgIC8vICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHByZXY7XHJcbiAgICAgICAgLy99XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIFRhZ1RlbXBsYXRlIGltcGxlbWVudHMgSU5vZGUge1xyXG4gICAgICAgIHByaXZhdGUgYXR0cmlidXRlczogeyBuYW1lOiBzdHJpbmc7IHRwbCB9W10gPSBbXTtcclxuICAgICAgICBwcml2YXRlIGV2ZW50cyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgLy8gUmVTaGFycGVyIGRpc2FibGUgb25jZSBJbmNvbnNpc3RlbnROYW1pbmdcclxuICAgICAgICBwcml2YXRlIF9jaGlsZHJlbjogSU5vZGVbXSA9IFtdO1xyXG4gICAgICAgIHB1YmxpYyBtb2RlbEFjY2Vzc29yO1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbmFtZTogc3RyaW5nLCBwcml2YXRlIG5zOiBzdHJpbmcpIHtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBjaGlsZHJlbigpOiBJTm9kZVtdIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGF0dHIobmFtZTogc3RyaW5nLCB0cGw6IGFueSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRBdHRyaWJ1dGUobmFtZSwgdHBsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHVibGljIGFkZEF0dHJpYnV0ZShuYW1lOiBzdHJpbmcsIHRwbDogYW55KSB7XHJcbiAgICAgICAgICAgIHZhciBhdHRyID0gdGhpcy5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIGlmICghYXR0cilcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5wdXNoKHsgbmFtZTogbmFtZS50b0xvd2VyQ2FzZSgpLCB0cGwgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGdldEF0dHJpYnV0ZShuYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBhdHRyID0gdGhpcy5hdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGF0dHIubmFtZSA9PT0ga2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhdHRyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgYWRkRXZlbnQobmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudHMuc2V0KG5hbWUsIGNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBhZGRDaGlsZChjaGlsZDogSU5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4ucHVzaChjaGlsZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIHNlbGVjdChtb2RlbEFjY2Vzc29yKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZWxBY2Nlc3NvciA9IG1vZGVsQWNjZXNzb3I7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWNjZXB0PFQ+KHZpc2l0b3I6IElWaXNpdG9yPFQ+LCBvcHRpb25zOiBhbnkpIHtcclxuICAgICAgICAgICAgdmFyIHRhZyA9IHZpc2l0b3IudGFnKHRoaXMubmFtZSwgdGhpcy5ucywgdGhpcy5hdHRyaWJ1dGVzLCBudWxsLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCh4ID0+IHguYWNjZXB0KHRhZykpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRhZztcclxuICAgICAgICAgICAgLy8gdmFyIGNvbnRlbnQgPSB2aXNpdG9yLmNvbnRlbnQobnVsbCwgY2hpbGRyZW4pO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0dXJuIHZpc2l0b3IudGFnKHRoaXMubmFtZSwgdGhpcy5ucywgdGhpcy5hdHRyaWJ1dGVzLCB0aGlzLmV2ZW50cywgY29udGVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2JpbmQoY29udGV4dCkge1xyXG4gICAgICAgIC8vICAgIGNvbnN0IG5ld0JpbmRpbmcgPSBuZXcgRG9tLlRhZ0JpbmRpbmcodGhpcy5uYW1lLCB0aGlzLm5zLCB0aGlzLmF0dHJpYnV0ZXMsIHRoaXMuZXZlbnRzKTtcclxuICAgICAgICAvLyAgICB0aGlzLmNoaWxkcmVuKClcclxuICAgICAgICAvLyAgICAgICAgLnJlZHVjZShDb250ZW50VGVtcGxhdGUucmVkdWNlQ2hpbGQsXHJcbiAgICAgICAgLy8gICAgICAgIHsgY29udGV4dCwgb2Zmc2V0OiAwLCBwYXJlbnRCaW5kaW5nOiBuZXdCaW5kaW5nLCBtb2RlbEFjY2Vzc29yOiB0aGlzLm1vZGVsQWNjZXNzb3IgfSk7XHJcblxyXG4gICAgICAgIC8vICAgIG5ld0JpbmRpbmcudXBkYXRlKGNvbnRleHQpO1xyXG5cclxuICAgICAgICAvLyAgICByZXR1cm4gbmV3QmluZGluZztcclxuICAgICAgICAvL31cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHtcclxuICAgIFRlbXBsYXRlIGFzIHRcclxufSJdfQ==